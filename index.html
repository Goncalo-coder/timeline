<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Timeline Builder</title>

<style>

:root{
  --bg:#0f172a;
  --bar:#6366f1;
  --line:#ef4444;
  --card:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
}

*{
  box-sizing:border-box;
  font-family:system-ui,sans-serif;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
}

.app{
  max-width:1200px;
  margin:auto;
  padding:30px 20px;
}

/* ================= CONTROLS ================= */

.controls{
  background:var(--card);
  padding:20px;
  border-radius:12px;
  margin-bottom:25px;

  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:15px;
}

.controls input,
.controls select,
.controls button{
  padding:10px;
  border-radius:6px;
  border:none;
  font-size:14px;
}

.controls button{
  background:var(--bar);
  color:white;
  cursor:pointer;
}

.controls button:hover{
  opacity:.9;
}

/* ================= CARD ================= */

.card{
  background:var(--card);
  border-radius:16px;
  padding:25px;
}

/* ================= HEADER ================= */

.header{
  text-align:center;
  margin-bottom:25px;
}

.header h1{
  margin:0;
  font-size:26px;
}

.header p{
  margin:5px 0 0;
  color:var(--muted);
}

/* ================= TIMELINE ================= */

.timeline-wrapper{
  position:relative;
  margin:25px 0;
  overflow:hidden;
}

.scale-row{
  display:flex;
  font-size:12px;
  color:var(--muted);
}

.scale-item{
  flex:1;
  text-align:center;
  border-right:1px solid #1e293b;
  padding-bottom:8px;
}

.scale-item:last-child{
  border:none;
}

/* Bar */

.bar-container{
  position:relative;
  height:40px;
  background:#020617;
  border-radius:20px;
  overflow:hidden;
}

.bar{
  position:absolute;
  inset:0;
  background:linear-gradient(90deg,var(--bar),#8b5cf6);
}

/* Today */

.today{
  position:absolute;
  top:-10px;
  bottom:-10px;
  width:2px;
  background:var(--line);
}

.today-label{
  position:absolute;
  top:-22px;
  transform:translateX(-50%);
  font-size:11px;
  color:var(--line);
}

/* ================= STATS ================= */

.stats{
  display:flex;
  justify-content:space-around;
  margin-top:25px;
  text-align:center;
}

.stat strong{
  font-size:26px;
  display:block;
}

.stat span{
  font-size:13px;
  color:var(--muted);
}

/* ================= SHARE ================= */

.share{
  margin-top:25px;
  text-align:center;
}

.share input{
  width:100%;
  padding:10px;
  border-radius:6px;
  border:none;
  background:#020617;
  color:white;
}

</style>
</head>

<body>

<div class="app">

<!-- ================= CONTROLS ================= -->

<div class="controls">

<input id="title" placeholder="Timeline title">

<input type="date" id="start">
<input type="date" id="end">

<select id="scale">
  <option value="day">Daily</option>
  <option value="week">Weekly</option>
  <option value="month">Monthly</option>
  <option value="quarter">Quarterly</option>
</select>

<input type="color" id="bg" title="Background">
<input type="color" id="bar" title="Bar color">
<input type="color" id="line" title="Today line">

<button onclick="generate()">Generate</button>

</div>

<!-- ================= PREVIEW ================= -->

<div class="card">

<div class="header">
  <h1 id="viewTitle"></h1>
  <p id="viewDates"></p>
</div>

<div class="timeline-wrapper">

<div class="scale-row" id="scaleRow"></div>

<div class="bar-container">

  <div class="bar"></div>

  <div class="today" id="todayLine"></div>
  <div class="today-label" id="todayLabel">Today</div>

</div>

</div>

<div class="stats">

<div class="stat">
  <strong id="total"></strong>
  <span id="unitLabel"></span>
</div>

<div class="stat">
  <strong id="percent"></strong>
  <span>Complete</span>
</div>

<div class="stat">
  <strong id="left"></strong>
  <span>Left</span>
</div>

</div>

<div class="share">

<p>Shareable URL</p>
<input id="shareLink" readonly>

</div>

</div>

</div>

<script>

/* ================= HELPERS ================= */

function qs(k){
  return new URLSearchParams(location.search).get(k);
}

function format(d){
  return d.toISOString().split("T")[0];
}

function diffDays(a,b){
  return Math.ceil((b-a)/86400000);
}

/* ================= DEFAULTS ================= */

const now = new Date();

const defaults = {
  title:"My Timeline",
  start:format(now),
  end:format(new Date(now.getFullYear(),now.getMonth()+1,now.getDate())),
  scale:"week",
  bg:"#0f172a",
  bar:"#6366f1",
  line:"#ef4444"
};

/* ================= INIT ================= */

const cfg = {
  title:qs("title") || defaults.title,
  start:qs("start") || defaults.start,
  end:qs("end") || defaults.end,
  scale:qs("scale") || defaults.scale,
  bg:qs("bg") || defaults.bg,
  bar:qs("bar") || defaults.bar,
  line:qs("line") || defaults.line
};

document.body.style.background = cfg.bg;
document.documentElement.style.setProperty("--bar",cfg.bar);
document.documentElement.style.setProperty("--line",cfg.line);

/* Fill controls */

title.value = cfg.title;
start.value = cfg.start;
end.value = cfg.end;
scale.value = cfg.scale;
bg.value = cfg.bg;
bar.value = cfg.bar;
line.value = cfg.line;

/* ================= BUILD ================= */

build();

function build(){

  const s = new Date(start.value);
  const e = new Date(end.value);
  const n = new Date();

  const totalDays = diffDays(s,e);
  const doneDays = Math.max(0,Math.min(totalDays,diffDays(s,n)));
  const percent = Math.round(doneDays/totalDays*100);

  viewTitle.textContent = title.value;
  viewDates.textContent =
    s.toDateString()+" â€” "+e.toDateString();

  renderScale(s,e,scale.value);

  /* Today line */

  if(n>=s && n<=e){

    const p = doneDays/totalDays*100;

    todayLine.style.left = p+"%";
    todayLabel.style.left = p+"%";

  }else{
    todayLine.style.display="none";
    todayLabel.style.display="none";
  }

  /* Stats */

  let units,total,left;

  if(scale.value==="day"){
    units=totalDays;
    unitLabel.textContent="Total Days";
  }

  if(scale.value==="week"){
    units=Math.ceil(totalDays/7);
    unitLabel.textContent="Total Weeks";
  }

  if(scale.value==="month"){
    units=(e.getFullYear()-s.getFullYear())*12+(e.getMonth()-s.getMonth());
    unitLabel.textContent="Total Months";
  }

  if(scale.value==="quarter"){
    units=Math.ceil(((e-s)/86400000)/90);
    unitLabel.textContent="Total Quarters";
  }

  left = Math.max(0,Math.round(units-units*(percent/100)));

  total.textContent = units;
  percent.textContent = percent+"%";
  left.textContent = left;

  /* Share URL */

  const url =
    location.origin+
    location.pathname+
    `?title=${encodeURIComponent(title.value)}`+
    `&start=${start.value}`+
    `&end=${end.value}`+
    `&scale=${scale.value}`+
    `&bg=${bg.value.replace("#","%23")}`+
    `&bar=${bar.value.replace("#","%23")}`+
    `&line=${line.value.replace("#","%23")}`;

  shareLink.value = url;
}

/* ================= SCALE ================= */

function renderScale(s,e,type){

  scaleRow.innerHTML="";

  if(type==="day"){
    let d=new Date(s);

    while(d<e){

      addScale(
        d.toLocaleDateString("en",{day:"2-digit",month:"short"})
      );

      d.setDate(d.getDate()+1);
    }
  }

  if(type==="week"){
    let d=new Date(s);
    let i=1;

    while(d<e){

      addScale("W"+i);
      i++;
      d.setDate(d.getDate()+7);
    }
  }

  if(type==="month"){
    let d=new Date(s);

    while(d<e){

      addScale(
        d.toLocaleDateString("en",{month:"short",year:"numeric"})
      );

      d.setMonth(d.getMonth()+1);
    }
  }

  if(type==="quarter"){
    let d=new Date(s);

    while(d<e){

      const q=Math.floor(d.getMonth()/3)+1;
      addScale("Q"+q+" "+d.getFullYear());

      d.setMonth(d.getMonth()+3);
    }
  }

}

function addScale(label){

  const div=document.createElement("div");
  div.className="scale-item";
  div.textContent=label;

  scaleRow.appendChild(div);
}

/* ================= GENERATE ================= */

function generate(){

  const url =
    location.pathname+
    `?title=${encodeURIComponent(title.value)}`+
    `&start=${start.value}`+
    `&end=${end.value}`+
    `&scale=${scale.value}`+
    `&bg=${bg.value.replace("#","%23")}`+
    `&bar=${bar.value.replace("#","%23")}`+
    `&line=${line.value.replace("#","%23")}`;

  location.href = url;
}

/* Auto refresh daily */

setInterval(build,3600000);

</script>

</body>
</html>
